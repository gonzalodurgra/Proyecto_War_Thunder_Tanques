<div class="container">
  
  <!-- ================================================================ -->
  <!-- HEADER CON AUTENTICACI√ìN -->
  <!-- ================================================================ -->
  <div class="app-header">
    <h1 class="header-title">
      <span class="title-full">üéÆ War Thunder - Base de Datos de Tanques</span>
      <span class="title-short">üéÆ War Thunder DB</span>
      <span class="title-mobile">üéÆ WT Tanques</span>
    </h1>
    
    <div class="user-section">
      @if (isAuthenticated) {
        <!-- Usuario autenticado -->
        <div class="user-menu">
          <button class="user-button" (click)="toggleMenuUsuario()">
            <span class="user-icon">üë§</span>
            <span class="username">{{ currentUsername }}</span>
            <span class="dropdown-icon">‚ñº</span>
          </button>
          
          @if (mostrarMenuUsuario) {
            <div class="dropdown-menu">
              <div class="user-info">
                <p><strong>{{ currentUsername }}</strong></p>
                <p class="user-role">
                  @if (isAdmin) {
                    <span class="badge-admin">üëë Administrador</span>
                  } @else {
                    <span>üìù Editor</span>
                  }
                </p>
              </div>
              
              @if (isAdmin) {
                <button class="dropdown-item" (click)="irAPanelAdmin()">
                  üõ°Ô∏è Panel de Admin
                </button>
              }
              
              <button class="dropdown-item logout" (click)="logout()">
                üö™ Cerrar Sesi√≥n
              </button>
            </div>
          }
        </div>
      } @else {
        <!-- Usuario no autenticado -->
        <div class="guest-section">
          <span class="guest-badge">üëÅÔ∏è Modo Lectura</span>
          <button class="btn-login-header" (click)="irALogin()">
            <span class="btn-text-full">Iniciar Sesi√≥n</span>
            <span class="btn-text-short">Login</span>
          </button>
        </div>
      }
    </div>
  </div>

  <!-- ================================================================ -->
  <!-- SECCI√ìN DE FILTROS -->
  <!-- ================================================================ -->
  <div class="filtros-container">
    <div class="filtros-header">
      <h2>Filtros</h2>
      
      @if (isAuthenticated) {
        <button (click)="crearNuevoTanque()" class="btn-crear-nuevo">
          ‚ûï Crear Nuevo Tanque
        </button>
      }
    </div>
    
    <div class="filtro">
      <label for="filtroNacion">Naci√≥n:</label>
      <select 
        id="filtroNacion" 
        [(ngModel)]="filtroNacion" 
        (change)="filtrarPorNacion()">
        <option value="">Todas las naciones</option>
        @for (nacion of naciones; track nacion) {
          <option [value]="nacion">{{ nacion }}</option>
        }
      </select>
    </div>

    <div class="filtro">
      <label for="filtroBusqueda">Buscar:</label>
      <input 
        type="text" 
        id="filtroBusqueda" 
        [(ngModel)]="filtroBusqueda"
        (input)="aplicarFiltroBusqueda()"
        placeholder="Nombre del tanque...">
    </div>

    <button (click)="limpiarFiltros()" class="btn-secundario">
      Limpiar filtros
    </button>

    <button (click)="cargarTanques()" class="btn-primario">
      üîÑ Recargar
    </button>
  </div>

  <!-- ================================================================ -->
  <!-- INFORMACI√ìN DE PAGINACI√ìN -->
  <!-- ================================================================ -->
  @if (!cargando && tanquesFiltrados.length > 0) {
    <div class="pagination-info">
      <p class="results-count">
        üìä Mostrando {{ getRangoTanques() }}
      </p>
    </div>
  }

  <!-- ================================================================ -->
  <!-- ESTADO DE CARGA -->
  <!-- ================================================================ -->
  @if (cargando) {
    <div class="mensaje-cargando">
      <p>‚è≥ Cargando tanques...</p>
    </div>
  }

  <!-- ================================================================ -->
  <!-- MENSAJE DE ERROR -->
  <!-- ================================================================ -->
  @if (error) {
    <div class="mensaje-error">
      <p>‚ùå {{ error }}</p>
    </div>
  }

  <!-- ================================================================ -->
  <!-- GRID DE TANQUES -->
  <!-- ================================================================ -->
  @if (!cargando && !error) {
    <div class="tanques-grid">
      @if (tanquesPaginados.length === 0) {
        <div class="sin-resultados">
          <p>No se encontraron tanques con los filtros aplicados</p>
        </div>
      } @else {
        @for (tanque of tanquesPaginados; track tanque._id) {
          <div class="tanque-card" (click)="seleccionarTanque(tanque)">
            
            <!-- Header con nombre y naci√≥n -->
            <div class="tanque-header">
              <h3>{{ tanque.nombre }}</h3>
              <span class="nacion-badge" [ngClass]="obtenerColorNacion(tanque.nacion)">
                {{ tanque.nacion }}
              </span>
            </div>

            <!-- Imagen del tanque -->
            @if (tanque.imagen_local) {
              <img [src]="tanque.imagen_local" [alt]="tanque.nombre">
            }
            
            <!-- Informaci√≥n b√°sica -->
            <div class="tanque-info">
              <p><strong>Rol:</strong> {{ tanque.rol }}</p>
              <p><strong>Rating</strong> {{ tanque.rating_arcade }}/{{ tanque.rating_realista}}</p>
              <p><strong>Peso:</strong> {{ tanque.peso }} t</p>
              <p><strong>Velocidad:</strong> {{ tanque.velocidad_adelante_arcade }}/{{tanque.velocidad_adelante_realista}} km/h</p>
            </div>

            <!-- Botones de acci√≥n -->
            <div class="tanque-acciones">
              <button 
                (click)="seleccionarTanque(tanque); $event.stopPropagation()" 
                class="btn-ver">
                üëÅÔ∏è Ver
              </button>
              
              @if (isAuthenticated) {
                <button 
                  (click)="editarTanque(tanque!); $event.stopPropagation()" 
                  class="btn-editar">
                  ‚úèÔ∏è Editar
                </button>
                <button 
                  (click)="eliminarTanque(tanque._id!); $event.stopPropagation()" 
                  class="btn-eliminar">
                  üóëÔ∏è
                </button>
              } @else {
                <button 
                  class="btn-disabled"
                  disabled
                  title="Inicia sesi√≥n para editar">
                  üîí Editar
                </button>
              }
            </div>
          </div>
        }
      }
    </div>
  }

  <!-- ================================================================ -->
  <!-- CONTROLES DE PAGINACI√ìN -->
  <!-- ================================================================ -->
  @if (!cargando && tanquesFiltrados.length > tanquesPorPagina) {
    <div class="pagination-container">
      
      <button 
        class="pagination-btn pagination-btn-nav"
        (click)="primeraPagina()"
        [disabled]="paginaActual === 1"
        title="Primera p√°gina">
        ‚èÆÔ∏è
      </button>
      
      <button 
        class="pagination-btn pagination-btn-nav"
        (click)="paginaAnterior()"
        [disabled]="paginaActual === 1"
        title="P√°gina anterior">
        ‚óÄÔ∏è
      </button>
      
      <div class="pagination-numbers">
        @for (pagina of paginasVisibles; track pagina) {
          <button 
            class="pagination-btn pagination-btn-number"
            [class.active]="pagina === paginaActual"
            (click)="irAPagina(pagina)">
            {{ pagina }}
          </button>
        }
      </div>
      
      <button 
        class="pagination-btn pagination-btn-nav"
        (click)="paginaSiguiente()"
        [disabled]="paginaActual === totalPaginas"
        title="P√°gina siguiente">
        ‚ñ∂Ô∏è
      </button>
      
      <button 
        class="pagination-btn pagination-btn-nav"
        (click)="ultimaPagina()"
        [disabled]="paginaActual === totalPaginas"
        title="√öltima p√°gina">
        ‚è≠Ô∏è
      </button>
      
    </div>
    
    <div class="pagination-details">
      <p>P√°gina {{ paginaActual }} de {{ totalPaginas }}</p>
    </div>
  }
<!-- ================================================================ -->
<!-- MODAL DE DETALLES DEL TANQUE CON ESTAD√çSTICAS COLOREADAS -->
<!-- ================================================================ -->
@if (tanqueSeleccionado) {
  <div class="modal-overlay" (click)="cerrarDetalles()">
    <div class="modal-contenido modal-ampliado" (click)="$event.stopPropagation()">
      
      <button class="btn-cerrar" (click)="cerrarDetalles()">‚úï</button>

      <h2>{{ tanqueSeleccionado.nombre }}</h2>
      
      <!-- Badge del rating con color y selector de modo -->
      <div class="rating-section">
        <div class="rating-badge">
          <span class="badge-rating">
            ‚≠ê Rating: {{ tanqueSeleccionado.rating_arcade }}
            @if (tanqueSeleccionado.rating_realista) {
              / {{ tanqueSeleccionado.rating_realista }}
            }
          </span>
        </div>

        <!-- Selector de modo de juego -->
        <div class="modo-selector">
          <button 
            class="btn-modo"
            [class.active]="modoActual === 'rating_arcade'"
            (click)="cambiarModo('rating_arcade')">
            üéÆ Arcade
          </button>
          <button 
            class="btn-modo"
            [class.active]="modoActual === 'rating_realista'"
            (click)="cambiarModo('rating_realista')">
            üéØ Realista
          </button>
        </div>
      </div>

      <!-- Toggle para estad√≠sticas avanzadas -->
      <div class="stats-toggle">
        <button 
          class="btn-toggle-stats" 
          (click)="toggleEstadisticasAvanzadas()">
          {{ mostrarEstadisticasAvanzadas ? 'üìä Ocultar' : 'üìä Mostrar' }} Estad√≠sticas Comparativas
        </button>
      </div>

      <!-- ================================================================ -->
      <!-- SECCI√ìN: Informaci√≥n General -->
      <!-- ================================================================ -->
      <div class="detalles-grid">
        <div class="detalle-seccion">
          <h3>‚ÑπÔ∏è Informaci√≥n General</h3>
          <p><strong>Naci√≥n:</strong> {{ tanqueSeleccionado.nacion }}</p>
          <p><strong>Rol:</strong> {{ tanqueSeleccionado.rol }}</p>
          
          <!-- Tripulaci√≥n con color y percentil -->
          <p>
            <strong>Tripulaci√≥n:</strong> 
            <span [style.color]="modoActual === 'rating_arcade' ? coloresTanque['tripulacion_arcade'] : coloresTanque['tripulacion_realista']" class="stat-colored">
              {{ tanqueSeleccionado.tripulacion }}
            </span>
            @if (mostrarEstadisticasAvanzadas) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'tripulacion', tanqueSeleccionado.tripulacion)) }}
              </span>
            }
          </p>
          
          <!-- Visibilidad con color (menor es mejor) -->
          <p>
            <strong>Visibilidad:</strong> 
            <span [style.color]="modoActual === 'rating_arcade' ? coloresTanque['visibilidad_arcade'] : coloresTanque['visibilidad_realista']" class="stat-colored">
              {{ tanqueSeleccionado.visibilidad }}%
            </span>
            @if (mostrarEstadisticasAvanzadas) {
              <span class="percentil-badge good">
                {{ formatearPercentil(100 - obtenerPercentil(tanqueSeleccionado, 'visibilidad', tanqueSeleccionado.visibilidad)) }}
              </span>
            }
          </p>
          
          <p><strong>Peso:</strong> {{ tanqueSeleccionado.peso }} t</p>
        </div>

        <!-- ================================================================ -->
        <!-- SECCI√ìN: Blindaje -->
        <!-- ================================================================ -->
        <div class="detalle-seccion">
          <h3>üõ°Ô∏è Blindaje</h3>
          
          <!-- Blindaje chasis con color -->
          <p>
            <strong>Blindaje chasis:</strong> 
            <span [style.color]="modoActual === 'rating_arcade' ? coloresTanque['blindaje_chasis_arcade']: coloresTanque['blindaje_chasis_realista']" class="stat-colored">
              {{ tanqueSeleccionado.blindaje_chasis }} mm
            </span>
            @if (mostrarEstadisticasAvanzadas) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'blindaje_chasis', tanqueSeleccionado.blindaje_chasis)) }}
              </span>
            }
          </p>
          
          <!-- Blindaje torreta con color -->
          <p>
            <strong>Blindaje torreta:</strong> 
            <span [style.color]="modoActual === 'rating_arcade' ? coloresTanque['blindaje_torreta_arcade']: coloresTanque['blindaje_torreta_realista']" class="stat-colored">
              {{ tanqueSeleccionado.blindaje_torreta }} mm
            </span>
            @if (mostrarEstadisticasAvanzadas) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'blindaje_torreta', tanqueSeleccionado.blindaje_torreta)) }}
              </span>
            }
          </p>
        </div>

        <!-- ================================================================ -->
        <!-- SECCI√ìN: Movilidad -->
        <!-- ================================================================ -->
        <div class="detalle-seccion">
          <h3>üèÉ Movilidad</h3>
          
          <!-- Velocidad adelante con color -->
          <p>
            <strong>Velocidad adelante:</strong>
            @if (modoActual == "rating_arcade") {
              <span [style.color]="coloresTanque['velocidad_adelante_arcade']" class="stat-colored">
                {{ tanqueSeleccionado.velocidad_adelante_arcade }}
              </span>
            } 
            @if (modoActual == "rating_realista") {
              <span [style.color]="coloresTanque['velocidad_adelante_realista']" class="stat-colored">
                {{ tanqueSeleccionado.velocidad_adelante_realista }}
              </span>
            }
            km/h
            @if (mostrarEstadisticasAvanzadas && modoActual == "rating_arcade") {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'velocidad_adelante_arcade', tanqueSeleccionado.velocidad_adelante_arcade)) }}
              </span>
            }
            @if (mostrarEstadisticasAvanzadas && modoActual == "rating_realista" ) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'velocidad_adelante_realista', tanqueSeleccionado.velocidad_adelante_realista)) }}
              </span>
            }
          </p>
          
          <!-- Velocidad atr√°s con color -->
          <p>
            <strong>Velocidad atr√°s:</strong> 
            @if (modoActual == "rating_arcade") {
              <span [style.color]="coloresTanque['velocidad_atras_arcade']" class="stat-colored">
                {{ tanqueSeleccionado.velocidad_atras_arcade }}
              </span>
            } 
            @if (modoActual == "rating_realista") {
              <span [style.color]="coloresTanque['velocidad_atras_realista']" class="stat-colored">
                {{ tanqueSeleccionado.velocidad_atras_realista }}
              </span>
            }
            km/h
            @if (mostrarEstadisticasAvanzadas && modoActual == "rating_arcade" ) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'velocidad_atras_arcade', tanqueSeleccionado.velocidad_atras_arcade)) }}
              </span>
            }
            @if (mostrarEstadisticasAvanzadas && modoActual == "rating_realista" ) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'velocidad_atras_realista', tanqueSeleccionado.velocidad_atras_realista)) }}
              </span>
            }
          </p>
          
          <!-- Relaci√≥n potencia/peso con color -->
          <p>
            <strong>Relaci√≥n potencia-peso:</strong> 
            @if (modoActual == "rating_arcade") {
              <span [style.color]="coloresTanque['potencia_peso_arcade']" class="stat-colored">
                {{ tanqueSeleccionado.relacion_potencia_peso }}
              </span>
            } 
            @if (modoActual == "rating_realista") {
              <span [style.color]="coloresTanque['potencia_peso_realista']" class="stat-colored">
                {{ tanqueSeleccionado.relacion_potencia_peso_realista }}
              </span>
            }
            hp/t
            @if (mostrarEstadisticasAvanzadas && modoActual == "rating_arcade") {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'relacion_potencia_peso', tanqueSeleccionado.relacion_potencia_peso)) }}
              </span>
            }
            @if (mostrarEstadisticasAvanzadas && modoActual == "rating_realista" ) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'relacion_potencia_peso_realista', tanqueSeleccionado.relacion_potencia_peso_realista)) }}
              </span>
            }
          </p>
        </div>

        <!-- ================================================================ -->
        <!-- SECCI√ìN: Armamento -->
        <!-- ================================================================ -->
        <div class="detalle-seccion">
          <h3>üî´ Armamento</h3>
          
          <!-- Recarga con color (menor es mejor) -->
          @if (tanqueSeleccionado.recarga) {
            <p>
              <strong>Recarga:</strong> 
              <span [style.color]="modoActual === 'rating_arcade' ? coloresTanque['recarga_arcade']: coloresTanque['recarga_realista']" class="stat-colored">
                {{ tanqueSeleccionado.recarga }}s
              </span>
              @if (mostrarEstadisticasAvanzadas) {
                <span class="percentil-badge good">
                  {{ formatearPercentil(100 - obtenerPercentil(tanqueSeleccionado, 'recarga', tanqueSeleccionado.recarga)) }}
                </span>
              }
            </p>
          }
          
          <!-- Cadencia con color -->
          @if (tanqueSeleccionado.cadencia) {
            <p>
              <strong>Cadencia:</strong> 
              <span [style.color]="modoActual === 'rating_arcade' ? coloresTanque['cadencia_arcade']: coloresTanque['cadencia_realista']" class="stat-colored">
                {{ tanqueSeleccionado.cadencia.toFixed(2) }} rpm
              </span>
              @if (mostrarEstadisticasAvanzadas) {
                <span class="percentil-badge">
                  {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'cadencia', tanqueSeleccionado.cadencia)) }}
                </span>
              }
            </p>
          }
          
          <p><strong>Munici√≥n total:</strong> {{ tanqueSeleccionado.municion_total }}</p>
          
          <!-- Depresi√≥n con color -->
          <p>
            <strong>Depresi√≥n:</strong> 
            <span [style.color]="modoActual === 'rating_arcade' ? coloresTanque['depresion_arcade']: coloresTanque['depresion_realista']" class="stat-colored">
              {{ tanqueSeleccionado.angulo_depresion }}¬∞
            </span>
            @if (mostrarEstadisticasAvanzadas) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'angulo_depresion', tanqueSeleccionado.angulo_depresion)) }}
              </span>
            }
          </p>
          
          <!-- Elevaci√≥n con color -->
          <p>
            <strong>Elevaci√≥n:</strong> 
            <span [style.color]="modoActual === 'rating_arcade' ? coloresTanque['elevacion_arcade']: coloresTanque['elevacion_realista']" class="stat-colored">
              {{ tanqueSeleccionado.angulo_elevacion }}¬∞
            </span>
            @if (mostrarEstadisticasAvanzadas) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'angulo_elevacion', tanqueSeleccionado.angulo_elevacion)) }}
              </span>
            }
          </p>
          
          <!-- Rotaci√≥n horizontal con color -->
          @if (tanqueSeleccionado.rotacion_torreta_horizontal_arcade) {
            <p>
              <strong>Rotaci√≥n horizontal:</strong> 
              @if (modoActual == "rating_arcade") {
                <span [style.color]="coloresTanque['rotacion_horizontal_arcade']" class="stat-colored">
                  {{ tanqueSeleccionado.rotacion_torreta_horizontal_arcade }}
                </span>
              } 
              @if (modoActual == "rating_realista") {
                <span [style.color]="coloresTanque['rotacion_horizontal_realista']" class="stat-colored">
                  {{ tanqueSeleccionado.rotacion_torreta_horizontal_realista }}
                </span>
              }
              ¬∫/s
              @if (mostrarEstadisticasAvanzadas && modoActual == "rating_arcade" ) {
                <span class="percentil-badge">
                  {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'rotacion_torreta_horizontal_arcade', tanqueSeleccionado.rotacion_torreta_horizontal_arcade)) }}
                </span>
              }
              @if (mostrarEstadisticasAvanzadas && modoActual == "rating_realista" ) {
              <span class="percentil-badge">
                {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'rotacion_torreta_horizontal_realista', tanqueSeleccionado.rotacion_torreta_horizontal_realista)) }}
              </span>
            }
            </p>
          }
          
          <!-- Rotaci√≥n vertical con color -->
          @if (tanqueSeleccionado.rotacion_torreta_vertical_arcade) {
            <p>
              <strong>Rotaci√≥n vertical:</strong> 
              @if (modoActual == "rating_arcade") {
                <span [style.color]="coloresTanque['rotacion_vertical_arcade']" class="stat-colored">
                  {{ tanqueSeleccionado.rotacion_torreta_vertical_arcade }}
                </span>
              } 
              @if (modoActual == "rating_realista") {
                <span [style.color]="coloresTanque['rotacion_vertical_realista']" class="stat-colored">
                  {{ tanqueSeleccionado.rotacion_torreta_vertical_realista }}
                </span>
              }
              ¬∫/s
              @if (mostrarEstadisticasAvanzadas && modoActual == "rating_arcade") {
                <span class="percentil-badge">
                  {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'rotacion_torreta_vertical_arcade', tanqueSeleccionado.rotacion_torreta_vertical_arcade)) }}
                </span>
              }
              @if (mostrarEstadisticasAvanzadas && modoActual == "rating_realista" ) {
                <span class="percentil-badge">
                  {{ formatearPercentil(obtenerPercentil(tanqueSeleccionado, 'rotacion_torreta_vertical_realista', tanqueSeleccionado.rotacion_torreta_vertical_realista)) }}
                </span>
              }
            </p>
          }
        </div>
      </div>

      <!-- ================================================================ -->
      <!-- SECCI√ìN: Setup 1 con penetraciones coloreadas -->
      <!-- ================================================================ -->
      @if (tanqueSeleccionado.setup_1) {
        <div class="setup-seccion">
          <h3>üî´ Setup 1</h3>
          @for (armaKey of Object.keys(tanqueSeleccionado.setup_1); track armaKey) {
            <div class="arma-detalle">
              <h4>{{ armaKey }}</h4>
              @for (municion of tanqueSeleccionado.setup_1[armaKey].municiones; track $index) {
                <div class="municion-detalle">
                  <p class="municion-header">
                    <strong>{{ municion.nombre }}</strong> 
                    <span class="municion-tipo-badge">{{ municion.tipo }}</span>
                  </p>
                  <ul class="penetracion-lista-coloreada">
                    <li>
                      <span class="distancia">0m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[0])">
                        {{ municion.penetracion_mm[0] }}mm
                      </span>
                      @if (mostrarEstadisticasAvanzadas) {
                        <span class="percentil-badge-small">
                          {{ formatearPercentil(obtenerPercentilPenetracion(municion.penetracion_mm[0])) }}
                        </span>
                      }
                    </li>
                    <li>
                      <span class="distancia">100m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[1])">
                        {{ municion.penetracion_mm[1] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">500m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[2])">
                        {{ municion.penetracion_mm[2] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">1000m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[3])">
                        {{ municion.penetracion_mm[3] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">1500m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[4])">
                        {{ municion.penetracion_mm[4] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">2000m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[5])">
                        {{ municion.penetracion_mm[5] }}mm
                      </span>
                    </li>
                  </ul>
                </div>
              }
            </div>
          }
        </div>
      }

      <!-- ================================================================ -->
      <!-- SECCI√ìN: Setup 2 con penetraciones coloreadas -->
      <!-- ================================================================ -->
      @if (tanqueSeleccionado.setup_2) {
        <div class="setup-seccion">
          <h3>üî´ Setup 2</h3>
          @for (armaKey of Object.keys(tanqueSeleccionado.setup_2); track armaKey) {
            <div class="arma-detalle">
              <h4>{{ armaKey }}</h4>
              @for (municion of tanqueSeleccionado.setup_2[armaKey].municiones; track $index) {
                <div class="municion-detalle">
                  <p class="municion-header">
                    <strong>{{ municion.nombre }}</strong> 
                    <span class="municion-tipo-badge">{{ municion.tipo }}</span>
                  </p>
                  <ul class="penetracion-lista-coloreada">
                    <li>
                      <span class="distancia">0m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[0])">
                        {{ municion.penetracion_mm[0] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">100m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[1])">
                        {{ municion.penetracion_mm[1] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">500m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[2])">
                        {{ municion.penetracion_mm[2] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">1000m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[3])">
                        {{ municion.penetracion_mm[3] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">1500m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[4])">
                        {{ municion.penetracion_mm[4] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">2000m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[5])">
                        {{ municion.penetracion_mm[5] }}mm
                      </span>
                    </li>
                  </ul>
                </div>
              }
            </div>
          }
        </div>
      }

      <!-- ================================================================ -->
      <!-- SECCI√ìN: Armamento Detallado con penetraciones coloreadas -->
      <!-- ================================================================ -->
      @if (tanqueSeleccionado.armamento) {
        <div class="setup-seccion">
          <h3>üî´ Armamento Detallado</h3>
          @for (armaKey of Object.keys(tanqueSeleccionado.armamento); track armaKey) {
            <div class="arma-detalle">
              <h4>{{ armaKey }}</h4>
              @for (municion of tanqueSeleccionado.armamento[armaKey].municiones; track $index) {
                <div class="municion-detalle">
                  <p class="municion-header">
                    <strong>{{ municion.nombre }}</strong> 
                    <span class="municion-tipo-badge">{{ municion.tipo }}</span>
                  </p>
                  <ul class="penetracion-lista-coloreada">
                    <li>
                      <span class="distancia">0m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[0])">
                        {{ municion.penetracion_mm[0] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">100m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[1])">
                        {{ municion.penetracion_mm[1] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">500m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[2])">
                        {{ municion.penetracion_mm[2] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">1000m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[3])">
                        {{ municion.penetracion_mm[3] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">1500m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[4])">
                        {{ municion.penetracion_mm[4] }}mm
                      </span>
                    </li>
                    <li>
                      <span class="distancia">2000m:</span>
                      <span 
                        class="penetracion-valor"
                        [style.color]="obtenerColorPenetracion(municion.penetracion_mm[5])">
                        {{ municion.penetracion_mm[5] }}mm
                      </span>
                    </li>
                  </ul>
                </div>
              }
            </div>
          }
        </div>
      }

    </div>
  </div>
}
</div>